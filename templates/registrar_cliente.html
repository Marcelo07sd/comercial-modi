{% extends 'base.html' %}

{% block content %}
<div class="container">
    <div class="text-center mb-4">
        <h2 class="fw-bold">Registrar Cliente</h2>
        <p class="text-muted">Complete la información del nuevo cliente</p>
    </div>

    <!-- Mensajes flash -->
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for category, message in messages %}
          <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Cerrar"></button>
          </div>
        {% endfor %}
      {% endif %}
    {% endwith %}

    <form method="POST" action="{{ url_for('registrar_cliente') }}" autocomplete="off">
        <div class="row g-3">

            <!-- Nombre y Apellidos -->
            <div class="col-md-4">
                <label for="nombre" class="form-label">Nombre</label>
                <input type="text" class="form-control" id="nombre" name="nombre" maxlength="20" required>
            </div>
            <div class="col-md-4">
                <label for="apellido_paterno" class="form-label">Apellido Paterno</label>
                <input type="text" class="form-control" id="apellido_paterno" name="apellido_paterno" maxlength="15" required>
            </div>
            <div class="col-md-4">
                <label for="apellido_materno" class="form-label">Apellido Materno</label>
                <input type="text" class="form-control" id="apellido_materno" name="apellido_materno" maxlength="15" required>
            </div>

            <!-- DNI -->
            <div class="col-md-4">
                <label for="dni" class="form-label">DNI</label>
                <input type="text" class="form-control" id="dni" name="dni" maxlength="8" required>
            </div>

            <!-- Dirección -->
            <div class="col-md-4">
                <label for="direccion" class="form-label">Dirección</label>
                <input type="text" class="form-control" id="direccion" name="direccion" maxlength="50">
            </div>
            <div class="col-md-4">
                <label for="referencia_direccion" class="form-label">Referencia</label>
                <input type="text" class="form-control" id="referencia_direccion" name="referencia_direccion" maxlength="20">
            </div>

            <!-- Teléfonos -->
            <div class="col-md-6">
                <label for="telefono_principal" class="form-label">Teléfono Principal</label>
                <input type="text" class="form-control" id="telefono_principal" name="telefono_principal" maxlength="20" required>
            </div>
            <div class="col-md-6">
                <label for="telefono_alternativo" class="form-label">Teléfono Alternativo</label>
                <input type="text" class="form-control" id="telefono_alternativo" name="telefono_alternativo" maxlength="20">
            </div>

            <!-- Email -->
            <div class="col-md-6">
                <label for="email" class="form-label">Correo Electrónico</label>
                <input type="email" class="form-control" id="email" name="email" maxlength="40">
            </div>
        </div>

        <!-- Cronómetro visible -->
        <div class="mt-4 mb-2 text-center">
            <span class="text-muted">Tiempo transcurrido: <strong id="cronometro">0</strong> segundos</span>
        </div>

        <!-- Campo oculto para enviar al backend -->
        <input type="hidden" name="tiempo_registro" id="tiempo_registro">

        <!-- Botones -->
        <div class="mt-4 text-center">
            <button type="submit" class="btn btn-primary">
                <i class="bi bi-person-plus"></i> Guardar Cliente
            </button>
            <a href="{{ url_for('index') }}" class="btn btn-secondary">
                <i class="bi bi-arrow-left"></i> Volver
            </a>
        </div>
    </form>
</div>

<!-- Script para cronómetro -->
<script>
    let tiempo = 0;
    const cronometro = document.getElementById('cronometro');
    const tiempoRegistroInput = document.getElementById('tiempo_registro');

    const timer = setInterval(() => {
        tiempo++;
        cronometro.textContent = tiempo;
        tiempoRegistroInput.value = tiempo;
    }, 1000);

    document.querySelector('form').addEventListener('submit', function () {
        clearInterval(timer);
    });
</script>
{% endblock %}
